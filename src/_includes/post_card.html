{% if post.index.tint_color or post.theme.color or is_index %}
  {% if post.index.tint_color %}
    {% assign color = post.index.tint_color %}
  {% elsif post.theme.color %}
    {% assign color = post.theme.color %}
  {% else %}
    {% assign color = "#d01c11" %}
  {% endif %}
<style>
  #post-{{ post.slug }}.card {
    border-color: {{ color }};
  }

  #post-{{ post.slug }} .card_title {
    color: {{ color }};
  }

  {% comment %}
  /* if post.index.best_of */
    #post-{{ post.slug }}.card {
      background: {{ color | rgba: 0.03 }};
    }

    #post-{{ post.slug }}.card a:hover {
      background: {{ color | rgba: 0.3 }};
    }

    #post-{{ post.slug }}.card.best_of {
      box-shadow: 0px 0px 7px {{ color | rgba: 0.6 }};
    }
  /* else */
  {% endcomment %}
    #post-{{ post.slug }}.card a:hover {
      background: {{ color | rgba: 0.2 }};
    }
  {% comment %}
  /* endif */
  {% endcomment %}
</style>
{% endif %}

<li
  class="card{% if post.index.best_of %} best_of{% endif %}"
  id="post-{{ post.slug }}"
  {%- if year %} data-post-year="{{ year }}"{% endif %}
  data-post-tags="{{ post.tags | join: ' ' }}"
>
  <a href="{{ post.url }}">
    {% comment %}
      Intentionally omit the alt text on promos, so screen reader users
      don't have to listen to the alt text before hearing the title
      of the item in the list.

      See https://github.com/wellcomecollection/wellcomecollection.org/issues/6007

      The data-proofer-ignore attribute will exclude this from the linting
      that checks images have alt text.
      See https://github.com/gjtorikian/html-proofer#ignoring-content
    {% endcomment %}

    <p class="card_image">
      {% if post.card.index %}
        {% assign year = post.date | date: "%Y" %}
        {% assign card_image = post.card.index %}
        <picture>
          <source
            srcset="
              /images/cards/{{ year }}/{{ card_image.name }}-1x.webp 1x,
              /images/cards/{{ year }}/{{ card_image.name }}-2x.webp 2x
            "
            type="image/webp"
          >
          <source
            srcset="
              /images/cards/{{ year }}/{{ card_image.name }}-1x{{ card_image.ext }} 1x,
              /images/cards/{{ year }}/{{ card_image.name }}-2x{{ card_image.ext }} 2x
            "
            type="{{ card_image.ext | mime_type }}"
          >
          <img
            src="/images/cards/{{ year }}/{{ card_image.name }}-1x{{ card_image.ext }}"
            alt=""
            loading="lazy"
            data-proofer-ignore
          />
        </picture>
      {% else %}
        <img
          src="/images/default-card.png"
          alt=""
          loading="lazy"
          data-proofer-ignore
        />
      {% endif %}
    </p>

    <div class="card_metadata">
      <p class="card_title">{{ post.title | render_markdown | smartify }}</p>
      <p class="card_description">
        {{ post.summary | smartify }}
      </p>
    </div>

    <div class="card_posting_date">
      <p>
        {{ post.date | date: "%-d %B&nbsp;%Y" }}
      </p>
    </div>
  </a>
</li>